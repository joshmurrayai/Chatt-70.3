<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tri Training Hub</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Archivo+Black&family=Work+Sans:wght@300;400;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #FF6B35;
            --secondary: #004E89;
            --accent: #F7B801;
            --dark: #1A1A2E;
            --light: #F5F5F5;
            --swim: #0096C7;
            --bike: #FF6B35;
            --run: #06A77D;
            --strength: #9B59B6;
        }
        
        body {
            font-family: 'Work Sans', sans-serif;
            background: linear-gradient(135deg, #1A1A2E 0%, #2D3142 100%);
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
            background-attachment: fixed;
        }
        
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }
        
        h1 {
            font-family: 'Archivo Black', sans-serif;
            font-size: 4rem;
            letter-spacing: -2px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            text-transform: uppercase;
            animation: slideDown 0.8s ease-out;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .race-countdown {
            font-size: 0.9rem;
            color: var(--accent);
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        .nav-bar {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            color: var(--light);
            padding: 12px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Work Sans', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .nav-btn:hover {
            background: rgba(255, 107, 53, 0.2);
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .nav-btn.active {
            background: var(--primary);
            border-color: var(--primary);
        }
        
        .date-navigator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }
        
        .date-nav-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--light);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .date-nav-btn:hover {
            background: var(--primary);
            transform: scale(1.1);
        }
        
        .current-date {
            font-size: 1.5rem;
            font-weight: 600;
            min-width: 200px;
            text-align: center;
        }
        
        .today-btn {
            background: var(--accent);
            border: none;
            color: var(--dark);
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .today-btn:hover {
            transform: scale(1.05);
        }
        
        .workout-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 20px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideUp 0.5s ease-out;
            position: relative;
            overflow: hidden;
        }
        
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .workout-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: var(--primary);
        }
        
        .workout-card.swim::before { background: var(--swim); }
        .workout-card.bike::before { background: var(--bike); }
        .workout-card.run::before { background: var(--run); }
        .workout-card.strength::before { background: var(--strength); }
        
        .workout-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .workout-type {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .workout-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .swim .workout-icon { background: var(--swim); }
        .bike .workout-icon { background: var(--bike); }
        .run .workout-icon { background: var(--run); }
        .strength .workout-icon { background: var(--strength); }
        
        .workout-content {
            display: grid;
            gap: 20px;
        }
        
        .workout-section {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
        }
        
        .section-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--accent);
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .section-content {
            font-size: 1.1rem;
            line-height: 1.6;
            font-weight: 300;
        }
        
        .completed-badge {
            background: var(--run);
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .log-workout-form {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            display: none;
        }
        
        .log-workout-form.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--accent);
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: var(--light);
            font-family: 'Work Sans', sans-serif;
            font-size: 1rem;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-family: 'Work Sans', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #FF8C61;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .btn-strava {
            background: #FC4C02;
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-strava:hover {
            background: #FF6B2C;
        }
        
        .strava-connect {
            text-align: center;
            padding: 30px;
            background: rgba(252, 76, 2, 0.1);
            border-radius: 20px;
            border: 2px dashed rgba(252, 76, 2, 0.3);
            margin-bottom: 30px;
        }
        
        .strava-connect h3 {
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .strava-connect p {
            margin-bottom: 20px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .rest-day {
            text-align: center;
            padding: 60px 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 25px;
            backdrop-filter: blur(15px);
        }
        
        .rest-day h2 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--accent);
        }
        
        .rest-day p {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .week-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .day-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .day-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
        }
        
        .day-card.current {
            border-color: var(--primary);
            background: rgba(255, 107, 53, 0.1);
        }
        
        .day-name {
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 1px;
        }
        
        .day-workout {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.08);
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        
        .stat-value {
            font-size: 3rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .stat-card.swim .stat-value { color: var(--swim); }
        .stat-card.bike .stat-value { color: var(--bike); }
        .stat-card.run .stat-value { color: var(--run); }
        .stat-card.total .stat-value { color: var(--accent); }
        
        .history-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .history-item {
            background: rgba(255, 255, 255, 0.08);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(15px);
            border-left: 5px solid var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .history-item:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateX(5px);
        }
        
        .history-item.swim { border-left-color: var(--swim); }
        .history-item.bike { border-left-color: var(--bike); }
        .history-item.run { border-left-color: var(--run); }
        .history-item.strength { border-left-color: var(--strength); }
        
        .history-date {
            font-size: 0.85rem;
            color: var(--accent);
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .history-type {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .history-details {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }
        
        .history-planned {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 8px;
            font-style: italic;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }
        
        .modal-content {
            background: #1A1A2E;
            padding: 30px;
            border-radius: 25px;
            max-width: 600px;
            width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: var(--light);
            font-size: 1.5rem;
            cursor: pointer;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }
            
            .workout-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .week-overview {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header>
            <h1>Tri Training Hub</h1>
            <div class="race-countdown">üèÅ Chattanooga 70.3 ¬∑ May 17, 2026</div>
        </header>
        
        <div id="stravaConnect" class="strava-connect">
            <h3>Connect with Strava</h3>
            <p>Auto-sync your completed workouts and track your progress</p>
            <button class="btn btn-strava" onclick="connectStrava()">
                <span>üîó</span> Connect Strava Account
            </button>
        </div>
        
        <div class="nav-bar">
            <button class="nav-btn active" onclick="showView('day')">Today</button>
            <button class="nav-btn" onclick="showView('week')">Week View</button>
            <button class="nav-btn" onclick="showView('history')">Training History</button>
            <button class="nav-btn" onclick="showView('calendar')">Calendar</button>
        </div>
        
        <div class="date-navigator">
            <button class="date-nav-btn" onclick="changeDate(-1)">‚Üê</button>
            <div class="current-date" id="currentDate">Monday, Jan 5, 2026</div>
            <button class="date-nav-btn" onclick="changeDate(1)">‚Üí</button>
            <button class="today-btn" onclick="goToToday()">Today</button>
        </div>
        
        <div id="workoutContainer"></div>
        
        <div id="stravaModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Connect to Strava</h2>
                    <button class="modal-close" onclick="closeStravaModal()">√ó</button>
                </div>
                <p style="margin-bottom: 20px; line-height: 1.6;">
                    To connect your Strava account, you'll need to:
                </p>
                <ol style="line-height: 2; margin-left: 20px; margin-bottom: 20px;">
                    <li>Create a Strava API application at <a href="https://www.strava.com/settings/api" target="_blank" style="color: var(--primary);">strava.com/settings/api</a></li>
                    <li>Get your Client ID and Client Secret</li>
                    <li>Authorize this app to access your activities</li>
                </ol>
                <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; margin-bottom: 20px;">
                    Note: This is a demo app. In a production version, these credentials would be securely stored on a server.
                </p>
                <div class="form-group">
                    <label>Client ID</label>
                    <input type="text" id="stravaClientId" placeholder="Enter your Strava Client ID">
                </div>
                <div class="form-group">
                    <label>Client Secret</label>
                    <input type="password" id="stravaClientSecret" placeholder="Enter your Strava Client Secret">
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" onclick="authorizeStrava()">Authorize Strava</button>
                    <button class="btn btn-secondary" onclick="closeStravaModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Training data parsed from the document
        const trainingData = {
            "Dec 1‚Äì7, 2025": {
                "Mon": { planned: "Run 45 min easy", actual: "6.05 / 9:23 / 57m / easy", type: "run" },
                "Tue": { planned: "Swim 40 min", actual: "1,340 yd / 1:53/100", type: "swim" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "10.79 / 30m / Intervals", type: "bike" },
                "Thu": { planned: "Rest", actual: "Rest", type: "rest" },
                "Fri": { planned: "Run 45 min easy", actual: "Rest- bad Cam night", type: "run" },
                "Sat": { planned: "Bike 60 min easy", actual: "Run / 5.02 / 8:15 / 41m", type: "bike" },
                "Sun": { planned: "Swim 45 min easy", actual: "", type: "swim" }
            },
            "Dec 8‚Äì14, 2025": {
                "Mon": { planned: "Run 45 min", actual: "Bike / 13 mi / 40m", type: "run" },
                "Tue": { planned: "Rest / Mobility", actual: "Rest", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "Run 6.03 mi / 8:26 / 51m / easy", type: "bike" },
                "Thu": { planned: "Swim 45 min technique", actual: "1,558 yd / 2:08/100 / 500yd long", type: "swim" },
                "Fri": { planned: "Run 45 min easy", actual: "8.5 mi / 8:50 pace", type: "run" },
                "Sat": { planned: "Bike 60 min easy", actual: "24.35 mi / 853 ft / 76 min", type: "bike" },
                "Sun": { planned: "Swim 45 min easy", actual: "Rest", type: "swim" }
            },
            "Dec 15‚Äì21, 2025": {
                "Mon": { planned: "Run 50 min steady", actual: "Stregth / Mobility", type: "run" },
                "Tue": { planned: "Rest", actual: "Swim 1,996 yds / 800yd long", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "Run 4.18mi  / 7:59 / 33m", type: "bike" },
                "Thu": { planned: "Swim 45 min", actual: "Bike 13.71 mi / 47min", type: "swim" },
                "Fri": { planned: "Run 40 min steady", actual: "Run 6.01 mi / 8.26 pace / 51 min", type: "run" },
                "Sat": { planned: "Bike 75 min steady", actual: "Bike 18.06 mi / 60 min", type: "bike" },
                "Sun": { planned: "Swim 40 min aerobic + drills", actual: "Rest", type: "swim" }
            },
            "Dec 22‚Äì28, 2025": {
                "Mon": { planned: "Run 60 min steady", actual: "Swim 1750 yd / 2.04 pace", type: "run" },
                "Tue": { planned: "Brick: Bike + Run", actual: "Bike 25.55 mi / 83 min / 1542 ft // Run 3.03 mi / 7.59 pace / 24 min", type: "bike" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "Rest", type: "bike" },
                "Thu": { planned: "Swim 45 min", actual: "Run  2 mi / 18 min", type: "swim" },
                "Fri": { planned: "Run 40 min steady", actual: "Run 6.13 mi / 9.33 pace / 60 min", type: "run" },
                "Sat": { planned: "Bike 75 min steady", actual: "Bike 18.55 mi / 60 min", type: "bike" },
                "Sun": { planned: "Swim 40 min aerobic + drills", actual: "Run 10.02 / 8.32 pace / 86 min", type: "swim" }
            },
            "Dec 29‚ÄìJan 4, 2026": {
                "Mon": { planned: "Run 60 min steady", actual: "Stregth / Mobility", type: "run" },
                "Tue": { planned: "Brick: Bike + Run", actual: "Bike 13.52 mi / 62 min / 1010 ft // Run 2.03 mi / 8.12 pace / 17 min", type: "bike" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "Rest", type: "bike" },
                "Thu": { planned: "Swim 45 min drills", actual: "Bike 8.26 mi / 30 min / 440 ft", type: "swim" },
                "Fri": { planned: "Run 45 min steady", actual: "Swim 2,297 yd / 46 min", type: "run" },
                "Sat": { planned: "Bike 90 min", actual: "Bike 26.16 mi / 90 min", type: "bike" },
                "Sun": { planned: "Swim 45 min technique + aerobic", actual: "Run 3.01 mi / 7:48 pace / 24 min", type: "swim" }
            },
            "Jan 5‚Äì11, 2026": {
                "Mon": { planned: "Rest", actual: "", type: "rest" },
                "Tue": { planned: "Run 60 min steady", actual: "", type: "run" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 45 min drills", actual: "", type: "swim" },
                "Fri": { planned: "Run 60 min steady", actual: "", type: "run" },
                "Sat": { planned: "Bike 90 min", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 90 min + Run 20 min", actual: "", type: "bike" }
            },
            "Jan 12‚Äì18, 2026": {
                "Mon": { planned: "Run 45 min easy", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Strength light", actual: "", type: "strength" },
                "Thu": { planned: "Swim 40 min", actual: "", type: "swim" },
                "Fri": { planned: "Run 40 min easy", actual: "", type: "run" },
                "Sat": { planned: "Bike 60 min easy", actual: "", type: "bike" },
                "Sun": { planned: "Swim 40 min easy skills", actual: "", type: "swim" }
            },
            "Jan 19‚Äì25, 2026": {
                "Mon": { planned: "Run 45 min easy", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Strength light", actual: "", type: "strength" },
                "Thu": { planned: "Swim 40 min", actual: "", type: "swim" },
                "Fri": { planned: "Run 40 min easy", actual: "", type: "run" },
                "Sat": { planned: "Bike 60 min easy", actual: "", type: "bike" },
                "Sun": { planned: "Swim 40 min easy skills", actual: "", type: "swim" }
            },
            "Jan 26‚ÄìFeb 1, 2026": {
                "Mon": { planned: "Run 60 min steady", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 45‚Äì50 min intervals", actual: "", type: "swim" },
                "Fri": { planned: "Run 60 min steady", actual: "", type: "run" },
                "Sat": { planned: "Bike 2 h endurance", actual: "", type: "bike" },
                "Sun": { planned: "Swim 45‚Äì50 min (OW if possible)", actual: "", type: "swim" }
            },
            "Feb 2‚Äì8, 2026": {
                "Mon": { planned: "Run 60 min steady", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 45‚Äì50 min intervals", actual: "", type: "swim" },
                "Fri": { planned: "Run 60 min steady", actual: "", type: "run" },
                "Sat": { planned: "Bike 2 h endurance", actual: "", type: "bike" },
                "Sun": { planned: "Swim 45‚Äì50 min (OW if possible)", actual: "", type: "swim" }
            },
            "Feb 9‚Äì15, 2026": {
                "Mon": { planned: "Run 60 min tempo", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 50 min technique + intervals", actual: "", type: "swim" },
                "Fri": { planned: "Run 60 min tempo", actual: "", type: "run" },
                "Sat": { planned: "Bike 2 h endurance", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 2 h + Run 20 min", actual: "", type: "bike" }
            },
            "Feb 16‚Äì22, 2026": {
                "Mon": { planned: "Run 60 min tempo", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 50 min", actual: "", type: "swim" },
                "Fri": { planned: "Run 60 min tempo", actual: "", type: "run" },
                "Sat": { planned: "Bike 2 h endurance", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 2 h + Run 20 min", actual: "", type: "bike" }
            },
            "Feb 23‚ÄìMar 1, 2026": {
                "Mon": { planned: "Run 75 min steady", actual: "", type: "run" },
                "Tue": { planned: "Rest / Easy swim", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 60 min", actual: "", type: "swim" },
                "Fri": { planned: "Run 75 min steady", actual: "", type: "run" },
                "Sat": { planned: "Bike 2.5 h endurance", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 2 h hilly + short run", actual: "", type: "bike" }
            },
            "Mar 2‚Äì8, 2026": {
                "Mon": { planned: "Run 75 min steady", actual: "", type: "run" },
                "Tue": { planned: "Rest / Easy swim", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 60 min", actual: "", type: "swim" },
                "Fri": { planned: "Run 75 min steady", actual: "", type: "run" },
                "Sat": { planned: "Bike 2.5 h endurance", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 2 h hilly + short run", actual: "", type: "bike" }
            },
            "Mar 9‚Äì15, 2026": {
                "Mon": { planned: "Run 45 min easy", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Strength light", actual: "", type: "strength" },
                "Thu": { planned: "Swim 40‚Äì50 min", actual: "", type: "swim" },
                "Fri": { planned: "Run 45‚Äì60 min steady", actual: "", type: "run" },
                "Sat": { planned: "Bike 90 min easy", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 90 min + Run 20 min", actual: "", type: "bike" }
            },
            "Mar 16‚Äì22, 2026": {
                "Mon": { planned: "Run 45 min easy", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Strength light", actual: "", type: "strength" },
                "Thu": { planned: "Swim 40‚Äì50 min", actual: "", type: "swim" },
                "Fri": { planned: "Run 45‚Äì60 min steady", actual: "", type: "run" },
                "Sat": { planned: "Bike 90 min easy", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 90 min + Run 20 min", actual: "", type: "bike" }
            },
            "Mar 23‚Äì29, 2026": {
                "Mon": { planned: "Run 75 min tempo", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 60 min (OW if possible)", actual: "", type: "swim" },
                "Fri": { planned: "Run 75 min tempo", actual: "", type: "run" },
                "Sat": { planned: "Bike 2.5 h race pace", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 3 h + Run 20‚Äì30 min", actual: "", type: "bike" }
            },
            "Mar 30‚ÄìApr 5, 2026": {
                "Mon": { planned: "Run 75 min tempo", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 60 min", actual: "", type: "swim" },
                "Fri": { planned: "Run 75 min tempo", actual: "", type: "run" },
                "Sat": { planned: "Bike 2.5 h race pace", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 3 h + Run 20‚Äì30 min", actual: "", type: "bike" }
            },
            "Apr 6‚Äì12, 2026": {
                "Mon": { planned: "Run 90 min steady", actual: "", type: "run" },
                "Tue": { planned: "Rest / Mobility", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 60 min", actual: "", type: "swim" },
                "Fri": { planned: "Run 90 min steady", actual: "", type: "run" },
                "Sat": { planned: "Bike 3 h incl. hills", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 3 h + Run 30 min", actual: "", type: "bike" }
            },
            "Apr 13‚Äì19, 2026": {
                "Mon": { planned: "Run 90 min steady", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 60 min", actual: "", type: "swim" },
                "Fri": { planned: "Run 90 min steady", actual: "", type: "run" },
                "Sat": { planned: "Bike 3 h incl. hills", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 3 h + Run 30 min", actual: "", type: "bike" }
            },
            "Apr 20‚Äì26, 2026": {
                "Mon": { planned: "Run 90 min steady", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 60 min race-pace sets", actual: "", type: "swim" },
                "Fri": { planned: "Run 90 min steady", actual: "", type: "run" },
                "Sat": { planned: "Bike 3‚Äì4 h long", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 2.5 h + Run 45 min", actual: "", type: "bike" }
            },
            "Apr 27‚ÄìMay 3, 2026": {
                "Mon": { planned: "Run 90 min steady", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 60 min", actual: "", type: "swim" },
                "Fri": { planned: "Run 90 min steady", actual: "", type: "run" },
                "Sat": { planned: "Bike 3‚Äì4 h long", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 2.5 h + Run 45 min", actual: "", type: "bike" }
            },
            "May 4‚Äì10, 2026": {
                "Mon": { planned: "Run 60 min steady", actual: "", type: "run" },
                "Tue": { planned: "Rest", actual: "", type: "rest" },
                "Wed": { planned: "Bike 30 / Strength 30 min", actual: "", type: "bike" },
                "Thu": { planned: "Swim 40 min w/ race pace", actual: "", type: "swim" },
                "Fri": { planned: "Run 60 min easy", actual: "", type: "run" },
                "Sat": { planned: "Bike 90 min w/ pickups", actual: "", type: "bike" },
                "Sun": { planned: "Brick: Bike 2 h + Run 30 min", actual: "", type: "bike" }
            },
            "May 11‚Äì17, 2026": {
                "Mon": { planned: "Run 30 min easy", actual: "", type: "run" },
                "Tue": { planned: "Rest or short swim", actual: "", type: "rest" },
                "Wed": { planned: "Strength mobility only", actual: "", type: "strength" },
                "Thu": { planned: "Swim 20‚Äì30 min easy", actual: "", type: "swim" },
                "Fri": { planned: "Run 20‚Äì30 min w/ pickups", actual: "", type: "run" },
                "Sat": { planned: "Rest + Race prep", actual: "", type: "rest" },
                "Sun": { planned: "RACE: 70.3 Chattanooga ‚Äì May 17!", actual: "", type: "race" }
            }
        };

        let currentDate = new Date(2026, 0, 5); // Jan 5, 2026
        let currentView = 'day';
        let stravaConnected = false;

        const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

        function getWeekRange(date) {
            const day = date.getDay();
            const diff = date.getDate() - day + (day === 0 ? -6 : 1);
            const monday = new Date(date);
            monday.setDate(diff);
            const sunday = new Date(monday);
            sunday.setDate(monday.getDate() + 6);
            
            const monthName = monthNames[monday.getMonth()];
            const endMonthName = monthNames[sunday.getMonth()];
            
            if (monday.getMonth() === sunday.getMonth()) {
                return `${monthName} ${monday.getDate()}‚Äì${sunday.getDate()}, ${monday.getFullYear()}`;
            } else {
                return `${monthName} ${monday.getDate()}‚Äì${endMonthName} ${sunday.getDate()}, ${monday.getFullYear()}`;
            }
        }

        function formatDate(date) {
            const dayName = dayNames[date.getDay()];
            const monthName = monthNames[date.getMonth()];
            return `${dayName}, ${monthName} ${date.getDate()}, ${date.getFullYear()}`;
        }

        function getWorkoutForDate(date) {
            const weekRange = getWeekRange(date);
            const dayName = dayNames[date.getDay()];
            
            if (trainingData[weekRange] && trainingData[weekRange][dayName]) {
                return trainingData[weekRange][dayName];
            }
            return null;
        }

        function getWorkoutIcon(type) {
            const icons = {
                'swim': 'üèä',
                'bike': 'üö¥',
                'run': 'üèÉ',
                'strength': 'üí™',
                'rest': 'üò¥',
                'race': 'üèÅ'
            };
            return icons[type] || 'üí™';
        }

        function renderDayView() {
            const workout = getWorkoutForDate(currentDate);
            const container = document.getElementById('workoutContainer');
            
            if (!workout) {
                container.innerHTML = `
                    <div class="rest-day">
                        <h2>No Workout Scheduled</h2>
                        <p>Enjoy your day off! üåü</p>
                    </div>
                `;
                return;
            }

            if (workout.type === 'rest') {
                container.innerHTML = `
                    <div class="rest-day">
                        <h2>Rest Day üò¥</h2>
                        <p>Recovery is when the magic happens. Take it easy today!</p>
                        ${workout.actual ? `<div style="margin-top: 20px; padding: 15px; background: rgba(255, 255, 255, 0.05); border-radius: 15px;"><strong>Notes:</strong> ${workout.actual}</div>` : ''}
                    </div>
                `;
                return;
            }

            const isCompleted = workout.actual && workout.actual.trim() !== '';
            const workoutId = `workout-${currentDate.getTime()}`;
            const isBrick = isBrickWorkout(workout.planned);
            
            let displayType = workout.type;
            let displayIcon = getWorkoutIcon(workout.type);
            let displayLabel = workout.type.toUpperCase();
            
            if (isBrick) {
                const brickTypes = getBrickWorkoutTypes(workout.planned);
                displayType = brickTypes[0]; // Use first type for color
                displayIcon = brickTypes.map(type => getWorkoutIcon(type)).join(' ');
                displayLabel = 'BRICK: ' + brickTypes.map(t => t.toUpperCase()).join(' + ');
            } else if (isCompleted) {
                const actualType = detectWorkoutType(workout.actual, workout.type);
                displayType = actualType;
                displayIcon = getWorkoutIcon(actualType);
                displayLabel = actualType.toUpperCase();
            }

            container.innerHTML = `
                <div class="workout-card ${displayType}">
                    <div class="workout-header">
                        <div class="workout-type">
                            <div class="workout-icon">${displayIcon}</div>
                            ${displayLabel}
                            ${isCompleted && !isBrick && displayType !== workout.type ? `<span style="font-size: 0.7rem; color: var(--accent); margin-left: 10px;">(Planned: ${workout.type})</span>` : ''}
                        </div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            ${isCompleted ? '<div class="completed-badge">‚úì Completed</div>' : ''}
                            <button class="btn-secondary" style="padding: 8px 15px; font-size: 0.8rem;" onclick="editPlannedWorkout()">‚úèÔ∏è Edit Plan</button>
                        </div>
                    </div>
                    
                    <div class="workout-content">
                        <div class="workout-section">
                            <div class="section-label">Planned Workout</div>
                            <div class="section-content" id="planned-display">${workout.planned}</div>
                            <div id="planned-edit" style="display: none;">
                                <div class="form-group">
                                    <label>Workout Type</label>
                                    <select id="planned-type" style="width: 100%; padding: 12px 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; color: var(--light); font-family: 'Work Sans', sans-serif; font-size: 1rem;">
                                        <option value="swim" ${workout.type === 'swim' ? 'selected' : ''}>üèä Swim</option>
                                        <option value="bike" ${workout.type === 'bike' ? 'selected' : ''}>üö¥ Bike</option>
                                        <option value="run" ${workout.type === 'run' ? 'selected' : ''}>üèÉ Run</option>
                                        <option value="strength" ${workout.type === 'strength' ? 'selected' : ''}>üí™ Strength</option>
                                        <option value="rest" ${workout.type === 'rest' ? 'selected' : ''}>üò¥ Rest</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Workout Description</label>
                                    <input type="text" id="planned-description" value="${workout.planned}" style="width: 100%; padding: 12px 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; color: var(--light); font-family: 'Work Sans', sans-serif; font-size: 1rem;">
                                </div>
                                <div class="form-actions">
                                    <button class="btn btn-primary" onclick="savePlannedWorkout()">Save Changes</button>
                                    <button class="btn btn-secondary" onclick="cancelEditPlanned()">Cancel</button>
                                </div>
                            </div>
                        </div>
                        
                        ${isCompleted ? `
                            <div class="workout-section">
                                <div class="section-label">Actual Workout ${isBrick ? '(Brick counts as ' + getBrickWorkoutTypes(workout.planned).length + ' workouts)' : ''}</div>
                                <div class="section-content">${workout.actual}</div>
                            </div>
                        ` : ''}
                    </div>
                    
                    ${!isCompleted ? `
                        <button class="btn btn-primary" style="margin-top: 20px;" onclick="toggleLogForm('${workoutId}')">
                            Log Workout
                        </button>
                        <div id="${workoutId}" class="log-workout-form">
                            <div class="form-group">
                                <label>Workout Type (if different from planned)</label>
                                <select id="${workoutId}-type" style="width: 100%; padding: 12px 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; color: var(--light); font-family: 'Work Sans', sans-serif; font-size: 1rem;">
                                    <option value="${workout.type}">Same as planned (${isBrick ? 'Brick' : workout.type})</option>
                                    <option value="swim">üèä Swim</option>
                                    <option value="bike">üö¥ Bike</option>
                                    <option value="run">üèÉ Run</option>
                                    <option value="strength">üí™ Strength</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Distance / Time</label>
                                <input type="text" id="${workoutId}-distance" placeholder="e.g., 6.05 mi / 57 min">
                            </div>
                            <div class="form-group">
                                <label>Pace / Speed</label>
                                <input type="text" id="${workoutId}-pace" placeholder="e.g., 9:23 pace">
                            </div>
                            <div class="form-group">
                                <label>Notes</label>
                                <textarea id="${workoutId}-notes" placeholder="How did it feel? Any observations?"></textarea>
                            </div>
                            <div class="form-actions">
                                <button class="btn btn-primary" onclick="saveWorkout('${workoutId}')">Save Workout</button>
                                <button class="btn btn-secondary" onclick="toggleLogForm('${workoutId}')">Cancel</button>
                                ${stravaConnected ? '<button class="btn btn-strava" onclick="importFromStrava()"><span>üì•</span> Import from Strava</button>' : ''}
                            </div>
                        </div>
                    ` : `
                        <button class="btn btn-secondary" style="margin-top: 20px;" onclick="toggleLogForm('${workoutId}')">
                            ‚úèÔ∏è Edit Workout
                        </button>
                        <div id="${workoutId}" class="log-workout-form">
                            <div class="form-group">
                                <label>Distance / Time</label>
                                <input type="text" id="${workoutId}-distance" value="${workout.actual}">
                            </div>
                            <div class="form-group">
                                <label>Workout Type</label>
                                <select id="${workoutId}-type-edit" style="width: 100%; padding: 12px 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; color: var(--light); font-family: 'Work Sans', sans-serif; font-size: 1rem;">
                                    <option value="swim" ${displayType === 'swim' ? 'selected' : ''}>üèä Swim</option>
                                    <option value="bike" ${displayType === 'bike' ? 'selected' : ''}>üö¥ Bike</option>
                                    <option value="run" ${displayType === 'run' ? 'selected' : ''}>üèÉ Run</option>
                                    <option value="strength" ${displayType === 'strength' ? 'selected' : ''}>üí™ Strength</option>
                                </select>
                            </div>
                            <div class="form-actions">
                                <button class="btn btn-primary" onclick="updateWorkout('${workoutId}')">Update Workout</button>
                                <button class="btn btn-secondary" onclick="toggleLogForm('${workoutId}')">Cancel</button>
                            </div>
                        </div>
                    `}
                </div>
            `;
        }

        let editingPlanned = false;

        function editPlannedWorkout() {
            document.getElementById('planned-display').style.display = 'none';
            document.getElementById('planned-edit').style.display = 'block';
            editingPlanned = true;
        }

        function cancelEditPlanned() {
            document.getElementById('planned-display').style.display = 'block';
            document.getElementById('planned-edit').style.display = 'none';
            editingPlanned = false;
        }

        function savePlannedWorkout() {
            const newType = document.getElementById('planned-type').value;
            const newDescription = document.getElementById('planned-description').value;
            
            const weekRange = getWeekRange(currentDate);
            const dayName = dayNames[currentDate.getDay()];
            
            if (trainingData[weekRange] && trainingData[weekRange][dayName]) {
                trainingData[weekRange][dayName].type = newType;
                trainingData[weekRange][dayName].planned = newDescription;
                renderDayView();
                editingPlanned = false;
            }
        }

        function updateWorkout(formId) {
            const newActual = document.getElementById(`${formId}-distance`).value;
            const newType = document.getElementById(`${formId}-type-edit`)?.value;
            
            const weekRange = getWeekRange(currentDate);
            const dayName = dayNames[currentDate.getDay()];
            
            if (trainingData[weekRange] && trainingData[weekRange][dayName]) {
                trainingData[weekRange][dayName].actual = newActual;
                renderDayView();
                alert('Workout updated! üéâ');
            }
        }


        function renderWeekView() {
            const weekRange = getWeekRange(currentDate);
            const weekData = trainingData[weekRange];
            const container = document.getElementById('workoutContainer');
            
            if (!weekData) {
                container.innerHTML = '<div class="rest-day"><h2>No workouts scheduled for this week</h2></div>';
                return;
            }

            let html = '<div class="week-overview">';
            
            ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'].forEach(day => {
                const workout = weekData[day];
                if (workout) {
                    const dayDate = getDayDate(currentDate, day);
                    const isCurrent = dayDate.toDateString() === currentDate.toDateString();
                    const isCompleted = workout.actual && workout.actual.trim() !== '';
                    
                    html += `
                        <div class="day-card ${isCurrent ? 'current' : ''}" onclick="navigateToDay('${day}')">
                            <div class="day-name">${getWorkoutIcon(workout.type)} ${day}</div>
                            <div class="day-workout">${workout.planned.substring(0, 30)}${workout.planned.length > 30 ? '...' : ''}</div>
                            ${isCompleted ? '<div style="margin-top: 8px; color: var(--run); font-weight: 600; font-size: 0.85rem;">‚úì Done</div>' : ''}
                        </div>
                    `;
                }
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        function renderHistoryView() {
            const container = document.getElementById('workoutContainer');
            
            // Calculate stats
            let stats = {
                total: 0,
                swim: 0,
                bike: 0,
                run: 0,
                strength: 0
            };
            
            let completedWorkouts = [];
            
            // Collect all completed workouts
            Object.keys(trainingData).forEach(weekRange => {
                ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'].forEach(day => {
                    const workout = trainingData[weekRange][day];
                    if (workout && workout.actual && workout.actual.trim() !== '' && workout.type !== 'rest') {
                        const dayDate = getDayDate(parseDateFromWeekRange(weekRange, day), day);
                        
                        // Check if this is a brick workout
                        const isBrick = isBrickWorkout(workout.planned);
                        
                        if (isBrick) {
                            // Brick workouts count as multiple types
                            const brickTypes = getBrickWorkoutTypes(workout.planned);
                            const actualType = detectWorkoutType(workout.actual, workout.type);
                            
                            completedWorkouts.push({
                                date: dayDate,
                                day: day,
                                plannedType: workout.type,
                                actualType: actualType,
                                planned: workout.planned,
                                actual: workout.actual,
                                weekRange: weekRange,
                                isBrick: true,
                                brickTypes: brickTypes
                            });
                            
                            stats.total++;
                            // Count each workout type in the brick
                            brickTypes.forEach(type => {
                                if (stats[type] !== undefined) {
                                    stats[type]++;
                                }
                            });
                        } else {
                            // Regular workout - detect actual workout type from the actual data
                            const actualType = detectWorkoutType(workout.actual, workout.type);
                            
                            completedWorkouts.push({
                                date: dayDate,
                                day: day,
                                plannedType: workout.type,
                                actualType: actualType,
                                planned: workout.planned,
                                actual: workout.actual,
                                weekRange: weekRange,
                                isBrick: false
                            });
                            
                            stats.total++;
                            if (stats[actualType] !== undefined) {
                                stats[actualType]++;
                            }
                        }
                    }
                });
            });
            
            // Sort by date (most recent first)
            completedWorkouts.sort((a, b) => b.date - a.date);
            
            let html = `
                <div class="stats-grid">
                    <div class="stat-card total">
                        <div class="stat-value">${stats.total}</div>
                        <div class="stat-label">Total Workouts</div>
                    </div>
                    <div class="stat-card swim">
                        <div class="stat-value">${stats.swim}</div>
                        <div class="stat-label">üèä Swims</div>
                    </div>
                    <div class="stat-card bike">
                        <div class="stat-value">${stats.bike}</div>
                        <div class="stat-label">üö¥ Bikes</div>
                    </div>
                    <div class="stat-card run">
                        <div class="stat-value">${stats.run}</div>
                        <div class="stat-label">üèÉ Runs</div>
                    </div>
                </div>
                
                <h2 style="margin-bottom: 20px; font-size: 1.8rem;">Recent Workouts</h2>
                <div class="history-list">
            `;
            
            if (completedWorkouts.length === 0) {
                html += `
                    <div class="rest-day">
                        <h2>No Completed Workouts Yet</h2>
                        <p>Start logging your workouts to see them here!</p>
                    </div>
                `;
            } else {
                completedWorkouts.forEach(workout => {
                    const dateStr = formatDate(workout.date);
                    
                    if (workout.isBrick) {
                        // Display brick workouts with multiple icons
                        const icons = workout.brickTypes.map(type => getWorkoutIcon(type)).join(' ');
                        const typeLabels = workout.brickTypes.map(type => type.toUpperCase()).join(' + ');
                        html += `
                            <div class="history-item ${workout.brickTypes[0]}" onclick="navigateToHistoricalDay('${workout.weekRange}', '${workout.day}')" style="border-left: 5px solid; border-image: linear-gradient(to bottom, var(--${workout.brickTypes[0]}), var(--${workout.brickTypes[1] || workout.brickTypes[0]})) 1;">
                                <div class="history-date">${dateStr}</div>
                                <div class="history-type">
                                    ${icons} BRICK: ${typeLabels}
                                </div>
                                <div class="history-details">${workout.actual}</div>
                                <div class="history-planned">Planned: ${workout.planned}</div>
                            </div>
                        `;
                    } else {
                        const typeChanged = workout.actualType !== workout.plannedType;
                        html += `
                            <div class="history-item ${workout.actualType}" onclick="navigateToHistoricalDay('${workout.weekRange}', '${workout.day}')">
                                <div class="history-date">${dateStr}</div>
                                <div class="history-type">
                                    ${getWorkoutIcon(workout.actualType)} ${workout.actualType.toUpperCase()}
                                    ${typeChanged ? `<span style="font-size: 0.8rem; color: var(--accent); margin-left: 10px;">(Planned: ${workout.plannedType})</span>` : ''}
                                </div>
                                <div class="history-details">${workout.actual}</div>
                                <div class="history-planned">Planned: ${workout.planned}</div>
                            </div>
                        `;
                    }
                });
            }
            
            html += '</div>';
            container.innerHTML = html;
        }
        
        function detectWorkoutType(actualText, plannedType) {
            const text = actualText.toLowerCase();
            
            // Check for explicit mentions of workout types
            if (text.includes('swim') || text.includes('yd') || text.includes('yard')) {
                return 'swim';
            }
            if (text.includes('bike') || text.includes('cycling')) {
                return 'bike';
            }
            if (text.includes('run') || text.includes('running') || text.includes('pace')) {
                return 'run';
            }
            if (text.includes('strength') || text.includes('mobility') || text.includes('stregth')) {
                return 'strength';
            }
            
            // If no explicit mention, check for workout-specific patterns
            // Swim: yards, 100s pace format
            if (/\d+\s*yd/.test(text) || /\d+:\d+\/100/.test(text)) {
                return 'swim';
            }
            
            // Bike: mi with elevation or longer distances
            if (/\d+\.?\d*\s*mi.*\d+\s*ft/.test(text) || /bike/i.test(text)) {
                return 'bike';
            }
            
            // Run: mi with pace format or shorter distances with pace
            if (/\d+\.?\d*\s*mi.*\d+:\d+\s*pace/.test(text) || /\d+:\d+\s*pace/.test(text)) {
                return 'run';
            }
            
            // Default to planned type if can't determine
            return plannedType;
        }
        
        function isBrickWorkout(plannedText) {
            return plannedText.toLowerCase().includes('brick');
        }
        
        function getBrickWorkoutTypes(plannedText) {
            const text = plannedText.toLowerCase();
            let types = [];
            
            if (text.includes('bike')) types.push('bike');
            if (text.includes('run')) types.push('run');
            if (text.includes('swim')) types.push('swim');
            
            return types.length > 0 ? types : ['bike', 'run']; // Default brick is bike + run
        }
        
        function parseDateFromWeekRange(weekRange, day) {
            const [startStr] = weekRange.split('‚Äì');
            const parts = startStr.trim().split(' ');
            
            let monthName, startDay, year;
            if (parts.length === 3) {
                monthName = parts[0];
                startDay = parseInt(parts[1]);
                year = parseInt(parts[2]);
            } else {
                monthName = parts[0];
                startDay = parseInt(parts[1]);
                year = 2025; // Default year
            }
            
            const monthIndex = monthNames.indexOf(monthName);
            const monday = new Date(year, monthIndex, startDay);
            
            return monday;
        }
        
        function navigateToHistoricalDay(weekRange, day) {
            const baseDate = parseDateFromWeekRange(weekRange, day);
            currentDate = getDayDate(baseDate, day);
            updateDateDisplay();
            showView('day');
        }


        function getDayDate(referenceDate, dayName) {
            const weekRange = getWeekRange(referenceDate);
            const [startStr] = weekRange.split('‚Äì');
            const parts = startStr.trim().split(' ');
            
            let monthName, startDay;
            if (parts.length === 2) {
                monthName = parts[0];
                startDay = parseInt(parts[1]);
            } else {
                monthName = parts[0];
                startDay = parseInt(parts[1]);
            }
            
            const monthIndex = monthNames.indexOf(monthName);
            const year = referenceDate.getFullYear();
            const monday = new Date(year, monthIndex, startDay);
            
            const dayOffset = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'].indexOf(dayName);
            const targetDate = new Date(monday);
            targetDate.setDate(monday.getDate() + dayOffset);
            
            return targetDate;
        }

        function navigateToDay(dayName) {
            const targetDate = getDayDate(currentDate, dayName);
            currentDate = targetDate;
            updateDateDisplay();
            showView('day');
        }

        function toggleLogForm(formId) {
            const form = document.getElementById(formId);
            form.classList.toggle('active');
        }

        function saveWorkout(formId) {
            const selectedType = document.getElementById(`${formId}-type`)?.value;
            const distance = document.getElementById(`${formId}-distance`).value;
            const pace = document.getElementById(`${formId}-pace`).value;
            const notes = document.getElementById(`${formId}-notes`).value;
            
            const weekRange = getWeekRange(currentDate);
            const dayName = dayNames[currentDate.getDay()];
            
            if (trainingData[weekRange] && trainingData[weekRange][dayName]) {
                // Build the actual workout string
                let actualParts = [];
                
                // Add workout type prefix if different from planned
                if (selectedType && selectedType !== trainingData[weekRange][dayName].type) {
                    actualParts.push(selectedType.charAt(0).toUpperCase() + selectedType.slice(1));
                }
                
                if (distance.trim()) actualParts.push(distance);
                if (pace.trim()) actualParts.push(pace);
                if (notes.trim()) actualParts.push(notes);
                
                trainingData[weekRange][dayName].actual = actualParts.join(' / ');
                renderDayView();
                alert('Workout saved! üéâ');
            }
        }

        function changeDate(days) {
            currentDate.setDate(currentDate.getDate() + days);
            updateDateDisplay();
            if (currentView === 'day') {
                renderDayView();
            } else if (currentView === 'week') {
                renderWeekView();
            }
        }

        function goToToday() {
            currentDate = new Date(2026, 0, 5);
            updateDateDisplay();
            if (currentView === 'day') {
                renderDayView();
            } else if (currentView === 'week') {
                renderWeekView();
            }
        }

        function updateDateDisplay() {
            document.getElementById('currentDate').textContent = formatDate(currentDate);
        }

        function showView(view) {
            currentView = view;
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            
            // Find and activate the correct button
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(btn => {
                if ((view === 'day' && btn.textContent === 'Today') ||
                    (view === 'week' && btn.textContent === 'Week View') ||
                    (view === 'history' && btn.textContent === 'Training History') ||
                    (view === 'calendar' && btn.textContent === 'Calendar')) {
                    btn.classList.add('active');
                }
            });
            
            if (view === 'day') {
                renderDayView();
            } else if (view === 'week') {
                renderWeekView();
            } else if (view === 'history') {
                renderHistoryView();
            } else if (view === 'calendar') {
                document.getElementById('workoutContainer').innerHTML = `
                    <div class="rest-day">
                        <h2>Calendar View</h2>
                        <p>Full calendar view coming soon! Use Week View to see your weekly schedule.</p>
                    </div>
                `;
            }
        }

        function connectStrava() {
            document.getElementById('stravaModal').classList.add('active');
        }

        function closeStravaModal() {
            document.getElementById('stravaModal').classList.remove('active');
        }

        function authorizeStrava() {
            const clientId = document.getElementById('stravaClientId').value;
            const clientSecret = document.getElementById('stravaClientSecret').value;
            
            if (!clientId || !clientSecret) {
                alert('Please enter both Client ID and Client Secret');
                return;
            }
            
            // In a real app, this would redirect to Strava OAuth
            alert('Strava authorization would happen here. In a production app, this would:\n\n1. Redirect to Strava OAuth\n2. Get authorization code\n3. Exchange for access token\n4. Store token securely\n5. Fetch activities via Strava API\n\nFor now, simulating connection...');
            
            stravaConnected = true;
            document.getElementById('stravaConnect').innerHTML = `
                <h3>‚úì Connected to Strava</h3>
                <p>Your workouts will automatically sync from Strava</p>
                <button class="btn btn-secondary" onclick="disconnectStrava()">Disconnect</button>
            `;
            closeStravaModal();
        }

        function disconnectStrava() {
            stravaConnected = false;
            document.getElementById('stravaConnect').innerHTML = `
                <h3>Connect with Strava</h3>
                <p>Auto-sync your completed workouts and track your progress</p>
                <button class="btn btn-strava" onclick="connectStrava()">
                    <span>üîó</span> Connect Strava Account
                </button>
            `;
        }

        function importFromStrava() {
            alert('This would fetch your most recent Strava activity and populate the workout fields automatically.');
        }

        // Initialize
        renderDayView();
    </script>
</body>
</html>